{%extends 'master/base.html'%} {%load static%} {%block content%}
<!-- ========================= SECTION CONTENT ========================= -->
<section class="section-conten padding-y bg">
  <div class="container">
    <div class="row">
     <aside class="col-md-3">
        {%include 'accounts/includes/sidebar.html'%}
      </aside>
      <main class="col-md-9">
        {% if orders %}
          {% for order in orders %}
            <article class="card mb-3">
              <header class="card-header">
                <strong class="d-inline-block mr-3">Order ID: {{ order.order_number }}</strong>
                <span>Order Date: {{ order.created_at|date:"d F Y" }}</span>
              </header>
              <div class="card-body">
                <div class="row">
                  <div class="col-md-8">
                    <h6 class="text-muted">Delivery to</h6>
                    <p>
                      {{ order.full_name }} <br />
                      Phone {{ order.phone }} Email: {{ order.email }} <br />
                      Location: {{ order.address_line_1 }}{% if order.address_line_2 %}, {{ order.address_line_2 }}{% endif %}, {{ order.city }}, {{ order.state }}{% if order.country %}, {{ order.country }}{% endif %}
                    </p>
                  </div>
                  <div class="col-md-4">
                    <h6 class="text-muted">Payment</h6>
                    <span class="text-success">
                      <i class="fab fa-lg fa-cc-visa"></i>
                      {% if order.payment %}
                        {{ order.payment.payment_method }} **** {{ order.payment.payment_id|slice:":4" }}
                      {% else %}
                        Pending
                      {% endif %}
                    </span>
                    <p>
                      Subtotal: Rs. {{ order.order_total|floatformat:2 }} <br />
                      Tax: Rs. {{ order.tax|floatformat:2 }} <br />
                      <span class="b">Total: Rs. {{ order.order_total|floatformat:2 }}</span>
                    </p>
                  </div>
                </div>
                <!-- row.// -->
              </div>
              <!-- card-body .// -->
              
              {% if order.orderproduct_set.all %}
                <div class="table-responsive">
                  <table class="table table-hover">
                    {% for order_product in order.orderproduct_set.all %}
                      <tr>
                        <td width="65">
                          {% if order_product.product.images %}
                            <img src="{{ order_product.product.images.url }}" class="img-xs border" alt="{{ order_product.product.product_name }}" />
                          {% else %}
                            <img src="{% static 'images/default-product.png' %}" class="img-xs border" alt="Default" />
                          {% endif %}
                        </td>
                        <td>
                          <p class="title mb-0">{{ order_product.product.product_name }}</p>
                          <var class="price text-muted">Rs. {{ order_product.product_price|floatformat:2 }}</var>
                        </td>
                        <td>
                          Quantity: {{ order_product.quantity }} <br />
                          {% if order_product.product.owner %}
                            Seller: {{ order_product.product.owner.first_name }}
                          {% endif %}
                        </td>
                        <td width="250">
                          <a href="{% url 'order_detail' order.order_number %}" class="btn btn-light">Details</a>
                        </td>
                      </tr>
                    {% endfor %}
                  </table>
                </div>
              {% else %}
                <div class="card-body">
                  <p class="text-muted">No products found for this order.</p>
                </div>
              {% endif %}
              <!-- table-responsive .end// -->
            </article>
          {% endfor %}
        {% else %}
          <article class="card">
            <div class="card-body text-center">
              <h5 class="text-muted">No orders found</h5>
              <p>You haven't placed any orders yet.</p>
              <a href="{% url 'store' %}" class="btn btn-primary">Start Shopping</a>
            </div>
          </article>
        {% endif %}
        <!-- order-group.// -->
      </main>
    </div>
    <!-- row.// -->
  </div>
</section>
<!-- ========================= SECTION CONTENT END// ========================= -->

{%endblock%}
